var Application = window.Application || function () {};
_.extend(Application.prototype, Backbone.Events, {
	set : function (e, t) {
		return this[e] = t,
		this
	},
	get : function (e) {
		return this[e]
	},
	use : function (e) {
		var t = this;
		if ("string" == typeof e) {
			var a = Application.require(e),
			i = function (e, n) {
				n = n || t;
				var o = "object" == typeof e ? e : e.split("/");
				if (o.length > 1) {
					var s = o.shift();
					n[s] = n[s] || {},
					i(o, n[s])
				} else
					n[o[0]] = a
			};
			i(e)
		} else
			this.stack || (this.stack = []), this.stack.push(e);
		return this
	},
	handle : function (e, t, a) {
		function i(s) {
			var r = n.stack[o++];
			if (!r)
				return a ? a(s) : (s && n.debug && console.error(s.stack || s.toString()), n);
			var c = r.length;
			s ? 4 === c ? r.call(n, s, e, t, i) : i(s) : 4 > c ? r.call(n, e, t, i) : i()
		}
		var n = this,
		o = 0,
		t = t || {};
		i()
	}
});
var Application = window.Application || function () {};
_.extend(Application, {
	exports : {},
	cache : {},
	define : function (e, t) {
		Application.exports[e] = t
	},
	require : function (e) {
		var t = {};
		if (e in Application.cache)
			return Application.cache[e];
		if (e in Application.exports)
			return Application.cache[e] = Application.exports[e].call(this, require, t.exports = {}, t) || t.exports;
		throw "Can't find module " + e
	}
});
var define = Application.define, require = Application.require, Application = window.Application || function () {};
Application.prototype.animate = {}, _.extend(Application.prototype.animate, {
	animEndEventName : "webkitAnimationEnd",
	isBack : !1,
	isAnimating : !1,
	endCurPage : !1,
	endNextPage : !1,
	outClass : "",
	inClass : "",
	blacklist : {
		bag : 1,
		choice : 1,
		rank : 1,
		cate : 1
	},
	_endAnimateHandler : function (e, t) {
		var a = this;
		$(".page-" + t).removeClass("animate-right animate-left").css("top", ""),
		$(".page-" + e).remove(),
		a.isBack || window.scrollTo(0, 0)
	},
	_beforeAnimate : function (e, t) {
		var a = this;
		return e && t && !this.isAnimating ? t in this.blacklist && e in this.blacklist || $.os.android && $.os.version <= "3" || void 0 == $.os.android && void 0 == $.os.ios || void 0 == $.os.version || $.os.android ? (a._endAnimateHandler.apply(a, arguments), !0) : void app.once("afterAnimate", function () {
			a._endAnimateHandler(e, t)
		}) : !0
	},
	_onEndAnimation : function (e, t) {
		this.endCurPage = !1,
		this.endNextPage = !1,
		this.isAnimating = !1,
		e.removeClass(this.outClass),
		t.removeClass(this.inClass)
	},
	_initEvt : function (e, t) {
		var a = this;
		a._beforeAnimate(e, t) || (a.isAnimating = !0, setTimeout(function () {
				$(".page-" + e).addClass(a.outClass).one(a.animEndEventName, function () {
					a.endCurPage = !0,
					a.endNextPage && (a._onEndAnimation($(".page-" + e), $(".page-" + t)), app.trigger("afterAnimate"))
				}),
				$(".page-" + t).addClass(a.inClass).one(a.animEndEventName, function () {
					a.endNextPage = !0,
					a.endCurPage && (a._onEndAnimation($(".page-" + e), $(".page-" + t)), app.trigger("afterAnimate"))
				})
			}, 100))
	},
	back : function () {
		this.outClass = "animate-pt animate-moveToRight",
		this.inClass = "animate-pt animate-moveFromLeft",
		this.isBack = !0,
		this._initEvt.apply(this, arguments)
	},
	forward : function () {
		this.outClass = "animate-pt animate-moveToLeft",
		this.inClass = "animate-pt animate-moveFromRight",
		this.isBack = !1,
		this._initEvt.apply(this, arguments)
	}
});
var Application = window.Application || function () {};
Application.prototype.navigate = {}, _.extend(Application.prototype.navigate, {
	el : "[data-target]",
	pages : {
		bag : 1,
		cate : 1,
		choice : 1,
		rank : 1,
		catedetail : 2,
		choicechannel : 2,
		choicesubject : 2,
		choicesubjectdetail : 3,
		rankdetail : 2,
		search : 2,
		searchsug : 3,
		searchresult : 4
	},
	initialize : function () {
		this.initEvt()
	},
	initEvt : function () {
		var e,
		t = this,
		a = location.href;
		$(".app").on("click", function (e) {
			var i,
			n,
			o,
			s = $(e.target),
			r = $(".app").data("page");
			if (o = t._getUrl(s), !o) {
				var c = t._getEle(s),
				p = c.data("href"),
				l = c.data("bookid"),
				d = c.data("gid"),
				u = c.data("from"),
				h = c.data("src"),
				f = "";
				return u && (f = "&from=" + u),
				void(p ? (l ? t._STATClick("bookid=" + l + f) : d && t._STATClick("gid=" + d + f), location.href = p) : l ? (t._STATClick("bookid=" + l + f), location.href = "http://m.baidu.com/tc?version=2&book_id=" + l + "&router=pagetpl&appui=alaxs") : d && h && (t._STATClick("gid=" + d + f), location.href = "http://m.baidu.com/tc?appui=alaxs&srct=zw&gid=" + d + "&srd=1&src=" + h))
			}
			if (i = o.page, i != r) {
				if ("back" == i)
					return void history.back();
				app.once("beforeRender", function (e) {
					e.addClass("animate-right animate-pt")
				}),
				app.once("afterRender", function () {
					a = location.href,
					app.state.set(".page-" + i, app.model[i].attributes),
					app.widget.loading.hide(),
					$(".page-" + i).css("top", window.scrollY),
					app.lazyload(),
					app.animate.forward(r, i)
				}),
				n = o.param ? o.page + "?" + o.param : o.page,
				app.router.navigate(n, {
					trigger : !0
				})
			}
		}),
		window.onpopstate = function () {
			if (e = location.href, a != e) {
				var i = location.pathname.substring(1) || "choice",
				n = function (e) {
					var i;
					$(".page-" + e).parent().children().each(function () {
						if (!$(this).hasClass("page-" + e))
							for (var t, a = $(this).attr("class").split(" "), n = 0; t = a[n++]; )
								if (/page-/.test(t))
									return i = t.replace("page-", ""), !0
					}),
					app.state.set(".page-" + e, app.model[e].attributes),
					app.widget.loading.hide(),
					app.lazyload(),
					a = i,
					t.pages[i] > t.pages[e] ? ($(".page-" + e).addClass("animate-left animate-pt"), app.animate.back(i, e)) : ($(".page-" + e).addClass("animate-right animate-pt").css("top", window.scrollY), app.animate.forward(i, e))
				};
				$(".page-" + i).length ? n(i) : app.once("afterRender", function () {
					n(i)
				})
			}
		}
	},
	_getEle : function (e) {
		var t = e.data("gid") || e.data("bookid");
		if (!t) {
			var a = e.parents("[data-gid]"),
			i = e.parents("[data-bookid]");
			a.length ? e = a : i.length && (e = i)
		}
		return e
	},
	_getUrl : function (e) {
		var t,
		a,
		i,
		n;
		return n = e.data("target"),
		n || (e = e.parents(this.el), n = e.data("target")) ? (/\?/g.test(n) ? (t = n.split("?"), a = t[0], i = t[1]) : a = n, {
			page : a,
			param : i
		}) : !1
	},
	_STATClick : function (e) {
		setTimeout(function () {
			$.ajax({
				type : "get",
				url : "/ajax/statistic/click?" + e
			})
		}, 0)
	}
});
var Application = window.Application || function () {};
Application.prototype.state = {}, _.extend(Application.prototype.state, {
	set : function (e, t) {
		$("title").text(t.page_name),
		$(e + " #J_title").text(t.page_name)
	},
	get : function () {}

});
var Application = window.Application || function () {};
Application.prototype.store = {}, _.extend(Application.prototype.store, function () {
	for (var e, t = function (e) {
		var t = !0;
		try {
			e.isStore = "true",
			e.removeItem("isStore")
		} catch (a) {
			t = !1
		}
		return t
	}, a = {
			set : function (e, a, i, n) {
				var o;
				t(e) && ("undefined" == typeof n ? e[a] = "string" == typeof i ? i : JSON.stringify(i) : (o = e[a] ? JSON.parse(e[a]) : {}, o[i] = n, e[a] = JSON.stringify(o)))
			},
			get : function (e, a, i) {
				var n,
				o;
				if (t(e))
					return o = e[a], o && (i === !0 && o ? o = JSON.parse(o) : "string" == typeof i && (n = JSON.parse(o), o = n && n[i])) , o
				},
				clear : function (e, a) {
					t(e) && ("undefined" == typeof a ? e.clear() : e.removeItem(a))
				}
			}, i = {}, n = ["session", "local"], o = ["set", "get", "clear"], s = 0; e = n[s++]; ) {
			i[e] = {};
			for (var r, c = 0; r = o[c++]; )
				!function (e, t) {
					i[e][t] = function () {
						var i = Array.prototype.slice.call(arguments);
						return i.unshift("session" == e ? sessionStorage : localStorage),
						a[t].apply(this, i)
					}
				}
			(e, r)
		}
	return i
}
	());
var Application = window.Application || function () {};
Application.prototype.widget = {}, _.extend(Application.prototype.widget, {
	tab : function () {
		var e = $(".tab-header");
		e.on("click", function (e) {
			var t = $(e.target).index(),
			a = $(this),
			i = a.next(),
			n = function (e) {
				e == t ? $(this).addClass("cur") : $(this).removeClass("cur")
			};
			a.find("li").each(n),
			i.length && i.hasClass("tab-container") && i.children().each(n)
		})
	},
	top : function () {
		var e = $(".top");
		e.length && (($.os.ios && parseInt($.os.version) < 5 || $.os.android && parseInt($.os.version) < 3) && (e.css("position", "absolute"), window.onscroll = function () {
				var t = window.scrollY + window.screen.height - 1.5 * e.width();
				t > document.body.offsetHeight || e.css("top", t)
			}), e.on("click", function () {
				window.scrollTo(0, 0)
			}))
	},
	loading : {
		show : function () {
			var e = $(".loading")[0];
			$(".loading").css({
				visibility : "visible",
				top : window.pageYOffset + .5 * (window.innerHeight - e.offsetHeight) + "px",
				left : .5 * (window.innerWidth - e.offsetWidth) + "px"
			})
		},
		hide : function () {
			$(".loading").css({
				top : 0,
				left : 0,
				visibility : "hidden"
			})
		}
	},
	more : function (e, t) {
		var a = this,
		i = $(a.name + "  .tip-morebtn");
		i.length && i.on("click", function (i) {
			var n = $(i.target),
			o = {},
			s = $(a.name + " .tip-moreicon"),
			r = n.data("filter"),
			c = n.data("pn");
			c > t || (n.text("努力加载中...."), s.removeClass().addClass("tip-loading tip-moreicon"), r && (o = {
						pn : c,
						filter : r
					}), a.model.more(r ? o : c, function (i) {
					if (i) {
						var o = _.template($("#list").html())(i);
						$(a.name + " " + e).append(o),
						n.data("pn", ++c),
						c > t ? (n.text("已经到最低啦~"), s.removeClass()) : (n.text("点击加载更多"), s.removeClass().addClass("tip-load tip-moreicon"))
					} else
						n.text("加载超时,请重试"), s.removeClass().addClass("tip-error tip-moreicon")
				}))
		})
	}
});
var Application = window.Application || function () {};
Application.prototype.lazyload = {}, _.extend(Application.prototype, {
	lazyload : function () {
		return setTimeout(function () {
			$("img.lazy").each(function () {
				var e = $(this).data("original");
				$(this).attr("src", e)
			})
		}, 0),
		this
	}
}), Application.define("model/bag", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				};
				$.ajax({
					type : "get",
					url : "/ajax/bag",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						t(e)
					},
					error : function () {}

				})
			},
			del : function (e) {
				$.ajax({
					type : "get",
					url : "/ajax/record/del?books=" + e,
					timeout : app.get("TIMEOUT")
				})
			}
		});
	a.exports = new i
}), Application.define("model/choice", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				},
				a = app.store.session.get("choice", !0);
				a ? t(a) : $.ajax({
					type : "get",
					url : "/ajax/choice",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("choice", e),
						t(e)
					},
					error : function () {}

				})
			}
		});
	a.exports = new i
}), Application.define("model/rank", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				},
				a = app.store.session.get("rank", !0);
				a ? t(a) : $.ajax({
					type : "get",
					url : "/ajax/rank",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("rank", e),
						t(e)
					},
					error : function () {}

				})
			}
		});
	a.exports = new i
}), Application.define("model/cate", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				},
				a = app.store.session.get("cate", !0);
				a ? t(a) : $.ajax({
					type : "get",
					url : "/ajax/cate",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("cate", e),
						t(e)
					},
					error : function () {}

				})
			}
		});
	a.exports = new i
}), Application.define("model/search", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				},
				a = app.store.session.get("search", !0);
				a ? t(a) : $.ajax({
					type : "get",
					url : "/ajax/search",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("search", e),
						t(e)
					},
					error : function () {}

				})
			},
			change : function (e, t) {
				$.ajax({
					type : "get",
					url : "/ajax/search?pn=" + e,
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						t(e)
					},
					error : function () {
						t()
					}
				})
			}
		});
	a.exports = new i
}), Application.define("model/searchsug", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = function (t) {
					t.r = Math.random(),
					e.set(t)
				},
				a = app.store.session.get("searchsug", !0);
				a ? (a.key = e.key, t(a)) : $.ajax({
					type : "get",
					url : "/ajax/searchsug",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("searchsug", e),
						t(e)
					},
					error : function () {}

				})
			},
			record : function (e) {
				this.key = e
			}
		});
	a.exports = new i
}), Application.define("model/searchresult", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function (e) {
				if (e) {
					this.param = e;
					var t = this,
					a = function (e) {
						e.r = Math.random(),
						t.set(e)
					},
					i = app.store.session.get("searchresult", e, !0);
					i ? a(i) : $.ajax({
						type : "get",
						url : "/ajax/searchresult?" + e,
						dataType : "json",
						timeout : app.get("TIMEOUT"),
						success : function (t) {
							app.store.session.set("searchresult", e, t),
							a(t)
						},
						error : function () {}

					})
				}
			},
			more : function (e, t) {
				var a,
				i = this;
				a = i.param ? "/ajax/searchresult?" + i.param + "&pn=" + e : "/ajax/searchresult" + location.search + "&pn=" + e,
				$.ajax({
					type : "get",
					url : a,
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						t(e)
					},
					error : function () {
						t()
					}
				})
			}
		});
	a.exports = new i
}), Application.define("model/rankdetail", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function (e) {
				if (e) {
					this.param = e;
					var t = this,
					a = function (e) {
						e.r = Math.random(),
						t.set(e)
					},
					i = app.store.session.get("rankdetail", e, !0);
					i ? a(i) : $.ajax({
						type : "get",
						url : "/ajax/rankdetail?" + e,
						dataType : "json",
						timeout : app.get("TIMEOUT"),
						success : function (t) {
							app.store.session.set("rankdetail", e, t),
							a(t)
						},
						error : function () {}

					})
				}
			},
			more : function (e, t) {
				var a,
				i = this;
				a = i.param ? "/ajax/rankdetail?" + i.param + "&pn=" + e : "/ajax/rankdetail" + location.search + "&pn=" + e,
				$.ajax({
					type : "get",
					url : a,
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (a) {
						for (var i, n = {}, o = [], s = a.ranklist[0].value, r = 0; i = s[r++]; )
							i = {
								book_id : i.book_id,
								logo : i.logo,
								book_type : 2,
								book_name : i.bookname,
								category_name : i.category_name,
								author : i.penname,
								book_status : i.bookstatus,
								mark : 1,
								mark_num : 20 * e + r,
								summary : i.description
							},
						o.push(i);
						n.list = o,
						t(n)
					},
					error : function () {
						t()
					}
				})
			}
		});
	a.exports = new i
}), Application.define("model/catedetail", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function (e) {
				if (e) {
					this.param = e;
					var t = this,
					a = app.store.session.get("catedetail", e, !0),
					i = function (e) {
						e.r = Math.random(),
						t.set(e)
					};
					a ? i(a) : $.ajax({
						type : "get",
						url : "/ajax/catedetail?" + e,
						dataType : "json",
						timeout : app.get("TIMEOUT"),
						success : function (t) {
							app.store.session.set("choicechannel", e, t),
							i(t)
						},
						error : function () {}

					})
				}
			},
			more : function (e, t) {
				var a,
				i = this;
				a = i.param ? "/ajax/catedetail?" + i.param + "&pn=" + e.pn + "&filter=" + e.filter : "/ajax/catedetail" + location.search + "&pn=" + e.pn + "&filter=" + e.filter,
				$.ajax({
					type : "get",
					url : a,
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						for (var a, i = {}, n = [], o = e.catelist[0].value, s = 0; a = o[s++]; )
							a = {
								book_id : a.book_id,
								logo : a.logo,
								book_type : 2,
								book_name : a.bookname,
								category_name : a.category_name,
								author : a.penname,
								book_status : a.bookstatus,
								mark : 1,
								mark_num : 20 * pn + s,
								summary : a.description
							},
						n.push(a);
						i.list = n,
						t(i)
					},
					error : function () {
						t()
					}
				})
			}
		});
	a.exports = new i
}), Application.define("model/choicechannel", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function (e) {
				if (e) {
					var t = this,
					a = app.store.session.get("choicechannel", e, !0),
					i = function (e) {
						e.r = Math.random(),
						t.set(e)
					};
					a ? i(a) : $.ajax({
						type : "get",
						url : "/ajax/choicechannel?" + e,
						dataType : "json",
						timeout : app.get("TIMEOUT"),
						success : function (t) {
							app.store.session.set("choicechannel", e, t),
							i(t)
						},
						error : function () {}

					})
				}
			}
		});
	a.exports = new i
}), Application.define("model/choicesubject", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function () {
				var e = this,
				t = app.store.session.get("choicesubject", !0),
				a = function (t) {
					t.r = Math.random(),
					e.set(t)
				};
				t ? a(t) : $.ajax({
					type : "get",
					url : "/ajax/choicesubject",
					dataType : "json",
					timeout : app.get("TIMEOUT"),
					success : function (e) {
						app.store.session.set("choicesubject", e),
						a(e)
					},
					error : function () {}

				})
			}
		});
	a.exports = new i
}), Application.define("model/choicesubjectdetail", function (e, t, a) {
	var i = Backbone.Model.extend({
			defaults : {},
			fetch : function (e) {
				if (e) {
					var t = this,
					a = function (e) {
						e.r = Math.random(),
						t.set(e)
					},
					i = app.store.session.get("choicesubjectdetail", e, !0);
					i ? a(i) : $.ajax({
						type : "get",
						url : "/ajax/choicesubjectdetail?" + e,
						dataType : "json",
						timeout : app.get("TIMEOUT"),
						success : function (t) {
							app.store.session.set("choicesubjectdetail", e, t),
							a(t)
						},
						error : function () {}

					})
				}
			}
		});
	a.exports = new i
}), Application.define("view/bag", function (e, t, a) {
	var i = e("model/bag"),
	n = Backbone.View.extend({
			name : ".page-bag",
			el : ".page",
			events : {
				"click .page-bag .operate-edit" : "_edit",
				"click .page-bag .operate-cancel" : "_cancel",
				"click .page-bag .operate-del" : "_del",
				"click .page-bag .content-showall" : "_allBag",
				"click .page-bag .recommend-showall" : "_allRecommend",
				"click .page-bag .content-hook .item" : "_select"
			},
			template : _.template($("#bag").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				this.initEvt()
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-bag"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				this.initEvt(),
				app.trigger("afterRender")
			},
			initEvt : function () {
				this._slide()
			},
			_edit : function (e) {
				$(e.target).addClass("hide"),
				$(".operate-cancel").removeClass("hide"),
				$(".operate-del").removeClass("hide"),
				$(".item-check").each(function () {
					$(this).removeClass("hide")
				}),
				$(".page-bag #J_bagList").data("state", "edit"),
				app.state.set(this.name, {
					page_name : "编辑管理"
				})
			},
			_cancel : function (e) {
				$(e.target).addClass("hide"),
				$(".operate-edit").removeClass("hide"),
				$(".operate-del").addClass("hide"),
				$(".item-check").each(function () {
					$(this).addClass("hide")
				}),
				$(".page-bag #J_bagList").data("state", ""),
				app.state.set(this.name, {
					page_name : "小说书城"
				})
			},
			_del : function () {
				var e,
				t,
				a,
				i = [];
				$(".item-check").each(function () {
					$(this).hasClass("selected") && (a = $(this).parents(".item"), e = a.data("bookid"), t = a.data("gid"), e ? i.push(e + "|2") : t && i.push(t + "|1"), a.remove())
				}),
				$(".page-bag .tip-num").text($(".page-bag .content-hook").children().length),
				i.length && this.model.del(i.join(","))
			},
			_select : function (e) {
				if ($(".page-bag #J_bagList").data("state")) {
					var t = $(e.currentTarget).find(".item-check");
					t.hasClass("selected") ? t.removeClass("selected") : t.addClass("selected"),
					e.stopPropagation(),
					e.preventDefault()
				}
			},
			_allBag : function () {
				var e = $(".page-bag .content-showall");
				e.hide(),
				$("#J_bagList").addClass("all")
			},
			_allRecommend : function () {
				var e = $(".page-bag .recommend-showall");
				e.hide(),
				$("#J_recommendList").addClass("all")
			},
			_slide : function () {
				if (this._initSlide(), $("#J_slide").length) {
					var e = this,
					t = 0,
					a = 0,
					i = 0,
					n = 0,
					o = e.offset - e.wt,
					s = 150,
					r = $("#J_slide"),
					c = new Hammer(r[0]);
					c.on("swipeleft swiperight", function (c) {
						switch (i = parseInt(r.css("left")), c.type) {
						case "swipeleft":
							if (a = i - e.offset, o > a)
								return r.css("left", o - s), void setTimeout(function () {
									r.css("left", o)
								}, 200);
							r.css("left", a),
							n += 1;
							break;
						case "swiperight":
							if (a = i + e.offset, a > t)
								return r.css("left", s), void setTimeout(function () {
									r.css("left", 0)
								}, 200);
							r.css("left", a),
							n -= 1
						}
						$("#J_slideIndex").find("li").each(function (e) {
							e == n ? $(this).addClass("cur") : $(this).removeClass("cur")
						})
					}),
					window.addEventListener("orientationchange", function () {
						setTimeout(function () {
							e.initSlide()
						}, 300)
					}, !1)
				}
			},
			_initSlide : function () {
				var e = this,
				t = $(".detail-row"),
				a = 30;
				e.wt = 0,
				t.children().each(function () {
					e.offset = document.body.offsetWidth - a,
					e.wt += e.offset,
					$(this).css("width", e.offset)
				}),
				t.css("width", e.wt)
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/choice", function (e, t, a) {
	var i = e("model/choice"),
	n = Backbone.View.extend({
			el : ".page",
			template : _.template($("#choice").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				app.widget.tab(),
				this._scale()
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-choice"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.widget.tab(),
				this._scale(),
				app.trigger("afterRender")
			},
			_scale : function () {
				$(".page-choice .recommend-item img").each(function () {
					var e = function (e) {
						var t = e.parent().width(),
						a = new Image;
						a.src = e[0].src,
						a.onload = function () {
							var i = a.width,
							n = a.height,
							o = t * n / i;
							e.parent().height(o)
						}
					};
					$(this)[0].onload = function () {
						e($(this))
					}
				})
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/rank", function (e, t, a) {
	var i = e("model/rank"),
	n = Backbone.View.extend({
			el : ".page",
			template : _.template($("#rank").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-rank"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender")
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/cate", function (e, t, a) {
	var i = e("model/cate"),
	n = Backbone.View.extend({
			el : ".page",
			events : {
				"click .page-cate .card-showall" : "_all"
			},
			template : _.template($("#cate").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-cate"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender")
			},
			_all : function (e) {
				var t = $(e.currentTarget),
				a = t.children(),
				i = t.parent().find(".grid");
				a.hasClass("all") ? (a.removeClass("all"), i.removeClass("all")) : (a.addClass("all"), i.addClass("all"))
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/search", function (e, t, a) {
	var i = e("model/search"),
	n = Backbone.View.extend({
			el : ".page",
			name : ".page-search",
			events : {
				"click .page-search #J_change" : "_change"
			},
			template : _.template($("#search").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-search"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender")
			},
			_change : function () {
				var e = this,
				t = Math.floor(10 * Math.random() / 2);
				this.model.change(t, function (t) {
					if (t) {
						var a = _.template($("#grid").html())(t);
						$(e.name + " .card-grid").html(a)
					}
				})
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/searchsug", function (e, t, a) {
	var i = e("model/searchsug"),
	n = Backbone.View.extend({
			el : ".page",
			events : {
				"input .page-searchsug .box-text" : "change"
			},
			template : _.template($("#searchsug").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				this.focus()
			},
			render : function () {
				var e,
				t = this;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-searchsug"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender"),
				$.os.ios && setTimeout(function () {
					t.focus()
				}, 200)
			},
			focus : function () {
				var e = $(".page-searchsug .box-text");
				e.length && e[0].focus()
			},
			change : function (e) {
				var t = $(e.currentTarget),
				a = $(".input-cancel"),
				i = t[0].value;
				i.length ? (a.text("搜索").data("target", "searchresult?word=" + i), this.model.record(i)) : a.text("取消").data("target", "back")
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/searchresult", function (e, t, a) {
	var i = e("model/searchresult"),
	n = Backbone.View.extend({
			name : ".page-searchresult",
			el : ".page",
			events : {},
			template : _.template($("#searchresult").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				this.initEvt()
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-searchresult"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				this.initEvt(),
				app.trigger("afterRender")
			},
			initEvt : function () {
				app.widget.top(),
				app.widget.more.call(this, ".content-container", 4)
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/rankdetail", function (e, t, a) {
	var i = e("model/rankdetail"),
	n = Backbone.View.extend({
			name : ".page-rankdetail",
			el : ".page",
			template : _.template($("#rankdetail").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				app.widget.top(),
				app.widget.more.call(this, ".content-container", 10)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-rankdetail"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.widget.top(),
				app.widget.more.call(this, ".content-container", 10),
				app.trigger("afterRender")
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/catedetail", function (e, t, a) {
	var i = e("model/catedetail"),
	n = Backbone.View.extend({
			el : ".page",
			name : ".page-catedetail",
			template : _.template($("#catedetail").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				this.initEvt()
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-catedetail"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				this.initEvt(),
				app.trigger("afterRender")
			},
			initEvt : function () {
				app.widget.tab(),
				app.widget.more.call(this, ".item-con", 10)
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/choicechannel", function (e, t, a) {
	var i = e("model/choicechannel"),
	n = Backbone.View.extend({
			el : ".page",
			template : _.template($("#choicechannel").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render),
				app.widget.tab()
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-choicechannel"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.widget.tab(),
				app.trigger("afterRender")
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/choicesubject", function (e, t, a) {
	var i = e("model/choicesubject"),
	n = Backbone.View.extend({
			el : ".page",
			template : _.template($("#choicesubject").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-choicesubject"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender")
			}
		});
	a.exports = new n({
			model : i
		})
}), Application.define("view/choicesubjectdetail", function (e, t, a) {
	var i = e("model/choicesubjectdetail"),
	n = Backbone.View.extend({
			el : ".page",
			template : _.template($("#choicesubjectdetail").html()),
			initialize : function () {
				this.listenTo(this.model, "change", this.render)
			},
			render : function () {
				var e;
				e = 0 == this.model.attributes.status ? $(this.template(this.model.attributes)) : $($("#error").html()).addClass("page-choicesubjectdetail"),
				app.trigger("beforeRender", e),
				this.$el.append(e),
				app.trigger("afterRender")
			}
		});
	a.exports = new n({
			model : i
		})
});
var Router = Backbone.Router.extend({
		routes : {
			"" : "all",
			":page" : "all",
			":page?:param" : "all"
		},
		all : function (e, t) {
			return location.pathname && "/" != location.pathname && e || (e = "choice"),
			$(".app").data("page", e),
			setTimeout(function () {
				var t = "";
				location.search && (t = "&" + location.search.substring(1)),
				$.ajax({
					type : "get",
					url : "/ajax/statistic/show?pageType=" + e + t
				})
			}, 0),
			app.get("isServerRender") ? app.set("isServerRender", !1) : (app.widget.loading.show(), require("model/" + e).fetch(t), void app.trigger("afterRoute"))
		}
	}), app = new Application;
app.set("TIMEOUT", 3e3).set("isServerRender", !0).use("model/bag").use("model/choice").use("model/rank").use("model/rankdetail").use("model/cate").use("model/catedetail").use("model/search").use("model/searchsug").use("model/searchresult").use("model/choicechannel").use("model/choicesubject").use("model/choicesubjectdetail").use("view/choice").use("view/rank").use("view/rankdetail").use("view/bag").use("view/cate").use("view/catedetail").use("view/search").use("view/searchsug").use("view/searchresult").use("view/choicechannel").use("view/choicesubject").use("view/choicesubjectdetail").use(function () {
	this.set("router", new Router),
	Backbone.history.start({
		pushState : !0,
		hashChange : !1
	}),
	this.navigate.initialize()
}), $(function () {
	FastClick.attach(document.body)
}), window.onload = function () {
	app.lazyload(),
	app.handle()
}, window.onpageshow = function (e) {
	e.persisted && (document.body.style.display = "none", location.reload())
};